## Executive Summary

An XML External Entity (XXE) vulnerability in opensagres XDocReport versions 0.9.2–2.0.3 (CVE-2025-65482) allows remote code execution when an application uses the library to process attacker-supplied DOCX documents. In affected deployments, an adversary can embed a malicious XML payload in a DOCX file and, when the server-side processing pipeline parses it with insecure SAX defaults, force outbound requests to arbitrary URLs or read local files, and potentially pivot to command execution depending on how the host application uses the parsed content. For organisations that accept DOCX uploads into automated report-generation workflows (HR/CRM/portal systems), this creates a direct, network-reachable path to compromise of the application server with no prior authentication.

Where XDocReport is only used offline by trusted staff or in tightly controlled back-office tooling, exploitation is much harder as an attacker must first gain access to those environments or persuade an internal user to process a crafted document. However, the existence of public proof-of-concept exploits, low attack complexity, and the prevalence of document-processing workflows over HTTP/HTTPS mean that in many generic enterprise and SaaS contexts, this XXE primitive is an attractive initial-access vector. From a kill chain economics perspective it combines low effort, high reliability, and high impact against internet-exposed file upload endpoints.

Assessment Tier: TIER 1 (Immediate – Network-Accessible RCE via File Upload)
Full analysis: https://github.com/alan-turing-institute/cyber-threat-observatory/blob/main/generic/T1/TIER_1_26-02-04_CVE-2025-65482.md
Rationale:
- Remote, unauthenticated exploitation via crafted DOCX where XDocReport backs an internet-facing upload workflow; PoC shows reliable XXE leading to sensitive file reads and external callbacks
- Public exploit code and detailed writeups significantly reduce attacker fixed costs
- Impact is high (server-side code execution / data access on application servers that often hold credentials and business data)
- Attack fits mass-scanning and opportunistic exploitation models against generic web applications using XDocReport
Attractiveness Score: HIGH
DPI Relevance: General Infrastructure (Document Processing / Middleware)
Vulners reference: https://vulners.com/cve/CVE-2025-65482

---

## In-Depth Analysis

### 1. Software and Deployment Context

- **Software:** opensagres XDocReport – Java library for generating reports from DOCX/ODT templates
- **Role:** Middleware component used by higher-level applications (e.g. portals, HR systems, custom line-of-business apps) to transform uploaded or template-based documents
- **Typical deployment:**
  - Embedded in web applications with endpoints that accept DOCX uploads
  - Used in batch or back-office processing services
- **Network reachability:**
  - XDocReport itself is not directly network-facing, but any HTTP/S endpoint that accepts DOCX and passes it to XDocReport exposes this vulnerability remotely
- **Execution context:**
  - Runs with the privileges of the hosting JVM (often application server accounts, which may have filesystem and database access)

The highest-risk profile is an internet-exposed web application that allows untrusted users to upload DOCX files for templated processing (e.g. CVs, forms, or reports).

### 2. Vulnerability Mechanics

- **Root cause:** The library uses a SAX parser configuration that allows external entities and DTD processing when parsing XML from DOCX parts.
- **Vulnerable pattern:** User-controlled DOCX content is parsed without disabling:
  - `external-general-entities`
  - `external-parameter-entities`
  - `DOCTYPE` declarations
- **Exploit path (per PoC):**
  1. Attacker crafts a DOCX whose `word/document.xml` contains an external entity definition pointing to an attacker-controlled URL or local file path.
  2. XDocReport’s XML parsing layer instantiates SAX without hardening features and resolves the external entity.
  3. This resolution triggers:
     - Outbound HTTP requests (data exfiltration via collaborator domains), and/or
     - Access to local files (e.g. `file:///etc/passwd` or application-specific data).
- **Impact escalation:** Combined with application logic that further processes entity-resolved content, attackers can escalate from SSRF/file disclosure to arbitrary code execution (e.g. via feeding attacker-controlled data into later deserialisation or scripting sinks).

### 3. Kill Chain Utility Assessment

**Initial access vs post-compromise**

- In internet-facing scenarios where:
  - A file upload endpoint accepts DOCX from unauthenticated or low-trust users, and
  - The backend uses XDocReport to parse those files
- The vulnerability provides a **direct, unauthenticated remote code execution or data exfiltration vector** against the application server.
- No existing foothold, credentials, or network positioning is required beyond being able to submit a document.

**Attacker gain**

- **Confidentiality:** Reading arbitrary local files or internal resources through XXE gives access to secrets, configuration, and user data.
- **Integrity/Availability:** Crafted entities can be chained into follow-on exploits or denial of service if critical resources are targeted.
- **Economics:** Public PoC code and detailed technical analysis reduce weaponisation costs; attackers can integrate checks into scanners targeting generic Java web apps that process DOCX.

**Barriers and complexity**

- Attack complexity is low:
  - Standard XXE primitives are sufficient, and PoC payloads are published.
  - No authentication or user interaction is required once an upload endpoint exists.
- The primary barrier is **environment fit**: only applications that wire untrusted DOCX input directly into XDocReport are exploitable. However, this is precisely how many templating/reporting features are built.

Given high impact and low barriers in common deployment patterns, CVE-2025-65482 has clear Tier 1 kill chain utility where such endpoints are exposed.

### 4. Organisational Context and DPI Relevance

- **DPI / critical infrastructure:** XDocReport is generic middleware, not DPI-specific. It may appear inside DPI operators’ back-office systems but is not core DPI by itself.
- **Generic enterprises and SMEs:** Any organisation running document-driven workflows (HR portals, customer self-service, claims/loan applications) is potentially exposed if they accept DOCX uploads and transform them server-side.
- **DPI relevance classification:** General Infrastructure – compromise would affect supporting systems rather than core national-scale DPI components, but still threatens data privacy and service continuity.

For both DPI and non-DPI environments, the key driver is whether DOCX upload and transformation are internet-accessible. In such cases, remediation should be prioritised in the immediate patch window.

### 5. Exploit Availability and Threat Signals

- **PoC status:** Public GitHub exploit and detailed writeups walk through:
  - Crafting malicious DOCX files
  - Triggering XXE resolution
  - Demonstrating exfiltration of local file contents and outbound callbacks
- **EPSS:** Current EPSS (~0.0007) is modest but reflects that this is a library-level issue rather than a single branded appliance, and detection of exploitation may be sparse.
- **In-the-wild indicators:** Sightings in CIRCL and security advisories, alongside PoCs, indicate active researcher attention and low marginal effort to fold this into generic exploit toolchains.

From a WAA perspective, this places CVE-2025-65482 firmly in the “ready to use when environment fits” category, justifying Tier 1 for exposed upload workflows.

### 6. Recommended Mitigations

- **Patch / upgrade:**
  - Upgrade to a non-vulnerable XDocReport release where XXE is disabled by default (per vendor patches).
  - Where immediate upgrade is not possible, harden XML parser configuration in the application:
    - `disallow-doctype-decl=true`
    - `external-general-entities=false`
    - `external-parameter-entities=false`
- **Architecture and validation:**
  - Treat all uploaded DOCX content as untrusted; validate file type and structure before processing.
  - Consider offloading document conversion to isolated services or sandboxes with minimal privileges and no outbound internet access.
- **Operational controls:**
  - Monitor outbound HTTP/HTTPS from application servers for anomalous destinations.
  - Review and restrict filesystem permissions for application identities to limit file disclosure blast radius.

These actions collectively reduce kill chain utility by increasing the barriers to exploitation and lowering the achievable gain from a successful XXE payload.

