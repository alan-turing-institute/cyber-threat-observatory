## Executive Summary

Docling Core (docling-core) exposes a Remote Code Execution (RCE) condition (CVE-2026-24009) via its reliance on insecure `PyYAML` deserialisation in `DoclingDocument.load_from_yaml()` when used with untrusted YAML and vulnerable PyYAML versions. In configurations where applications accept YAML documents from external sources and pass them directly into this API, an attacker can craft payloads that invoke arbitrary Python object construction and, through known `PyYAML` gadgets, execute code on the host processing the document. The vulnerability is gated by both docling-core and PyYAML versions and by how the consuming application uses the API, but where all conditions align it provides a clear RCE path.

From a kill chain perspective this is a **high-impact but environment-dependent deserialisation flaw**. It is unlikely to be universally exploitable across all docling-core users, as many pipelines consume only trusted YAML or have PyYAML fixed, but in document-ingest or data-processing services that accept YAML from external tenants, this is a powerful execution vector. Given these prerequisites and the need for application-specific context, the issue fits best as a Tier 2 “high value but barriered” vulnerability rather than a Tier 1 perimeter auto-exploit.

Assessment Tier: TIER 2 (High Value but Barriered – YAML Deserialisation RCE)
Full analysis: https://github.com/alan-turing-institute/cyber-threat-observatory/blob/main/generic/T2/TIER_2_26-02-04_CVE-2026-24009.md
Rationale:
- Leverages known `PyYAML` unsafe loading behaviour (CVE-2020-14343) to expose RCE through docling-core’s YAML document API
- Exploitation requires specific conditions: vulnerable PyYAML, use of `load_from_yaml()` on untrusted YAML, and a reachable ingestion channel
- Impact is high where docling-based pipelines are network-accessible and process tenant- or customer-supplied YAML at scale
- Barriers around configuration and ingestion patterns justify Tier 2 classification under Kill Chain Economics
Attractiveness Score: MEDIUM–HIGH (Where YAML Ingestion is Exposed)
DPI Relevance: General Infrastructure (Document Processing / Data Pipelines)
Vulners reference: https://vulners.com/cve/CVE-2026-24009

---

## In-Depth Analysis

### 1. Software and Deployment Context

- **Software:** docling-core, the core types and transformation library for the Docling document-processing stack
- **Role:** Provides document model abstractions and serialisation/deserialisation utilities, including YAML-based persistence via `DoclingDocument.load_from_yaml()`
- **Typical deployment:**
  - Backend services and pipelines that convert, annotate, or analyse documents
  - Used in Python applications or microservices which may run in containers, cloud functions, or on-prem data-processing nodes
- **Network reachability:**
  - docling-core itself is a library, but it often sits behind:
    - REST or gRPC APIs that accept document representations
    - Batch ingestion jobs that pull YAML from queues or storage

The effective attack surface is defined by how the consuming application exposes YAML ingestion to external parties.

### 2. Vulnerability Mechanics

- **Root cause:** `DoclingDocument.load_from_yaml()` deserialises YAML using `yaml.FullLoader`, which executes arbitrary constructors and object graphs, mirroring PyYAML’s unsafe defaults.
- **Exploit conditions:**
  - Application uses docling-core version ≥ 2.21.0 and < 2.48.4.
  - Installed PyYAML version is < 5.4 (i.e. still vulnerable to CVE-2020-14343).
  - The application calls `load_from_yaml()` on YAML that can be influenced by an attacker.
- **Attack example:**
  - Attacker crafts YAML containing `!!python/object/apply` gadgets that cause arbitrary command execution or file operations when deserialized.
  - When docling-core passes this payload to `yaml.FullLoader`, PyYAML instantiates the objects and executes the associated operations.
- **Remediation in docling-core 2.48.4:**
  - Switches from `yaml.FullLoader` to `yaml.SafeLoader`, removing code-execution semantics from untrusted YAML.

This is a classic unsafe-deserialisation anti-pattern, with docling-core as the exposure point.

### 3. Kill Chain Utility Assessment

**Initial access vs post-compromise**

- CVE-2026-24009 can act as an **initial-access RCE vector** when:
  - YAML ingestion endpoints are internet-facing or accessible from untrusted tenants, and
  - YAML is passed directly to `load_from_yaml()` without prior validation or isolation.
- In other settings, such as internal-only pipelines processing trusted content, it is effectively inert.

**Attacker gain**

- In exploitable deployments, gains include:
  - Execution of arbitrary Python code or shell commands with the privileges of the document-processing service
  - Access to documents, metadata, and secrets present in the processing environment
  - Ability to pivot within cloud or on-prem infrastructures, especially where docling-based services sit adjacent to data lakes or ML pipelines.

**Barriers and reliability**

- Barriers:
  - Requires specific version combinations of docling-core and PyYAML.
  - Requires that untrusted YAML reaches the vulnerable API; many applications use docling-core only with internal or pre-sanitised data.
- Reliability:
  - PyYAML gadget chains for RCE are well-documented; once the ingestion path is confirmed, exploitation is stable and automatable.

Overall, the vulnerability has high impact but is constrained by deployment and configuration preconditions, aligning with Tier 2 under the Kill Chain Economics model.

### 4. Organisational Context and DPI Relevance

- **DPI / critical infrastructure:**
  - Docling-core may be part of document-intelligence or analytics workloads in government or critical sectors, but it is not specific to DPI.
- **Enterprise and research environments:**
  - Particularly relevant to:
    - API-driven document-analysis SaaS
    - Data science pipelines that accept user-submitted YAML for configuration or document representation
    - Integration with other Python-based microservices
- **DPI classification:** General Infrastructure – risk profile depends on whether document-processing APIs are exposed beyond strictly internal users.

For environments where untrusted YAML is normal (multi-tenant systems, customer-driven automation), this vulnerability should be treated as a priority RCE risk.

### 5. Exploit Availability and Threat Signals

- **Underlying CVE:** Relies on a well-known PyYAML issue (CVE-2020-14343) with abundant exploit material and gadget examples in the public domain.
- **Vendor acknowledgement:** The docling-core advisory and patch note explicitly reference the move to `yaml.SafeLoader`, confirming the exposure and recommended remediation.
- **EPSS and telemetry:** As a library-level flaw, EPSS may underrepresent risk, but for attackers focusing on Python ecosystems and document ingestion services, the combination of known gadgets and an accessible API is attractive.

Given the maturity of PyYAML exploitation techniques, weaponising this docling-core vector primarily requires environment reconnaissance, not new research.

### 6. Recommended Mitigations

- **Upgrade and dependency hygiene:**
  - Upgrade docling-core to **2.48.4 or later**, which uses `yaml.SafeLoader` by default.
  - Independently upgrade `PyYAML` to version **5.4 or later** across the environment to remove the underlying unsafe deserialisation behaviour.
- **API and ingestion hardening:**
  - Avoid accepting raw YAML from untrusted parties where possible; prefer neutral formats (JSON) and strict schemas.
  - Validate and sanitize incoming YAML before passing it into any deserialization routines.
  - Enforce strict schemas and reject documents that contain unexpected tags or constructors.
- **Execution environment controls:**
  - Run document-processing services in sandboxed containers or restricted runtime environments with:
    - Least-privilege identities
    - Limited filesystem and network access
  - Monitor for anomalous process creation or outbound network connections from docling-based services.

By upgrading and enforcing safe deserialisation patterns, organisations can significantly reduce the kill chain utility of CVE-2026-24009 and similar YAML-RCE risks.

