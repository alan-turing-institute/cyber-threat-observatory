## Executive Summary

CVE-2026-25141 is a follow-on code-injection vulnerability in Orval, a TypeScript/JavaScript client generator for OpenAPI/Swagger specifications. It represents an incomplete fix for CVE-2026‑23947: although Orval introduced escaping for certain characters in `jsStringEscape`, versions 7.19.0–7.20.x and 8.0.0–8.1.x still allow attackers to inject arbitrary JavaScript into generated clients by using only a restricted set of characters (`[]()!+`) and JSFuck-style encoding. When untrusted OpenAPI specifications are processed and their schema descriptions are turned into code, this can result in arbitrary code execution in environments consuming the generated clients.

As with CVE‑2026‑23947, exploitation requires that a threat actor can feed malicious OpenAPI specs into Orval pipelines that generate and then execute client code. This is a **supply-chain deserialisation/code-generation issue**, not a direct network RCE on production servers. It is high impact in environments that process external API definitions automatically, but tightly scoped to specific workflows. Under Kill Chain Economics, this vulnerability has substantial arsenal value in targeted supply-chain or build-system intrusion campaigns, but its prerequisites and niche deployment profile place it in Tier 3 rather than Tier 1.

Assessment Tier: TIER 3 (Arsenal Value – Incomplete Fix Code Injection in Orval Clients)
Full analysis: https://github.com/alan-turing-institute/cyber-threat-observatory/blob/main/generic/T3/TIER_3_26-02-04_CVE-2026-25141.md
Rationale:
- Builds on CVE‑2026‑23947 by bypassing the initial `jsStringEscape` fix with JSFuck-style payloads using limited characters
- Exploitation requires untrusted OpenAPI specs to be ingested into Orval and their generated clients executed
- High impact when exploited (arbitrary code execution in developer/CI environments), but strong environmental prerequisites and limited mass-exploitation potential
- Fits Tier 3 as a specialised supply-chain attack tool in attacker arsenals
Attractiveness Score: MEDIUM–HIGH (for Targeted Supply-Chain Attacks)
DPI Relevance: General Infrastructure (Developer Tooling / API Client Generation)
Vulners reference: https://vulners.com/cve/CVE-2026-25141

---

## In-Depth Analysis

### 1. Software and Deployment Context

- **Software:** Orval – OpenAPI/Swagger client generator for TypeScript/JavaScript
- **Affected versions:** 7.19.0–7.20.x and 8.0.0–8.1.x (prior to 7.21.0 and 8.2.0)
- **Role:** Generates API client code and models from OpenAPI definitions, often during build or CI steps
- **Deployment:**
  - Used in frontend and backend projects to automate client generation
  - Integrated into CI pipelines, Monorepos, and developer tooling setups

The vulnerable surface is in **build-time code generation**, not in live server endpoints.

### 2. Vulnerability Mechanics

- **Background:** CVE‑2026‑23947 identified code injection via unsanitised `x-enumDescriptions` values. Orval patched this by escaping quotes and some special characters using `jsStringEscape`.
- **Root cause of CVE‑2026‑25141:** The fix failed to account for code constructions that rely solely on a limited set of non-escaped characters `[]()!+`. Attackers can:
  - Use JSFuck (or similar techniques) to encode arbitrary JavaScript using only those characters.
  - Embed such payloads into schema descriptions (e.g. `x-enumDescriptions`).
  - Have Orval’s generator output them into const enums or other generated code paths where they are evaluated.
- **Impact path:**
  1. Attacker crafts an OpenAPI spec with JSFuck payload embedded in description fields.
  2. Orval processes the spec and produces client code containing the encoded payload.
  3. During build or runtime, the payload executes in the environment where the generated client is built or run (e.g. Node, CI runner).

This effectively resurrects the code-injection primitive that CVE‑2026‑23947 sought to remove.

### 3. Kill Chain Utility Assessment

**Prerequisites**

- Exploitation requires:
  - A project using vulnerable Orval versions.
  - A pipeline that:
    - Accepts OpenAPI specs from untrusted or semi-trusted sources (vendors, third-party APIs, user uploads), and
    - Automatically runs Orval and executes or builds the resulting clients.

**Attacker gain**

- In suitable environments, attackers gain:
  - Code execution in CI/build agents or developer machines, which often have access to:
    - Source repositories
    - Secrets and tokens
    - Deployment or signing infrastructure
- This can be used to:
  - Plant backdoors in application code
  - Exfiltrate credentials and artifacts
  - Pivot into internal networks.

**Barriers and reliability**

- Barriers:
  - Not all Orval deployments ingest untrusted specs; many use static, first-party definitions.
  - The attack requires successful introduction of a malicious spec into the toolchain (e.g. via repo compromise or malicious upstream provider).
- Reliability:
  - With public PoCs and thoroughly described gadget chains, JSFuck-based payloads can be made highly reliable.

Given these factors, CVE‑2026‑25141 offers strong arsenal value in sophisticated supply-chain operations but is not a broad-spectrum perimeter RCE.

### 4. Organisational Context and DPI Relevance

- **DPI and enterprise:** Orval may appear in toolchains of government, financial, or infrastructure entities, but always as part of the development lifecycle, not as a core DPI platform.
- **Risk profile:** Threat is concentrated in:
  - CI/CD platforms
  - Developer workstations
  - Application source repositories
- **DPI classification:** Treated as general developer infrastructure; impact is indirect on DPI, mediated by code that Orval helps produce.

In environments where OpenAPI specs are tightly controlled and versioned, risk is lower but still worth addressing due to potential insider and supply-chain scenarios.

### 5. Recommended Mitigations

- **Upgrade and patching:**
  - Upgrade Orval to **7.21.0 or 8.2.0 and later**, where the `jsStringEscape` logic and related fixes close this injection vector.
  - Validate that both `@orval/core` and any wrapper packages are updated.
- **Input trust and pipeline design:**
  - Treat OpenAPI specifications as untrusted input when sourced from third parties or shared repositories.
  - Require code review for changes to OpenAPI documents used by Orval in CI.
  - Avoid automatically executing newly generated clients in high-privilege contexts without isolation.
- **Execution environment controls:**
  - Run generation and build steps in sandboxed, least-privilege containers.
  - Limit available tooling and network access in CI jobs that process external specs.
  - Monitor CI and developer environments for anomalous child processes spawned during code generation or builds.

These measures, combined with timely patching, significantly reduce the attractiveness and practical utility of CVE‑2026‑25141 as part of attacker arsenals.

