## Executive Summary

CVE-2025-70849 is an arbitrary file upload and stored cross-site scripting (XSS) vulnerability in podinfo through version 6.9.0 (and related advisories mention ≤ 6.10.0). The `/store` endpoint allows unauthenticated users to POST arbitrary content, which is then retrievable via a content hash. Because the application renders stored content without a restrictive Content-Security-Policy (CSP) and with insufficient Content-Type validation, attackers can upload HTML/JavaScript payloads that execute when anyone visits the corresponding URL.

Podinfo is a demonstration microservice often deployed in test clusters and lab environments, but it is also sometimes exposed on public internet endpoints. While the vulnerability is trivially exploitable and unauthenticated, its impact is limited to client-side script execution in the context of podinfo pages—it does not directly compromise the underlying cluster or any backend services. Accordingly, from a Kill Chain Economics perspective, this is a Tier 3 stored XSS issue: useful for phishing, browser-based attacks, or red-team demonstrations, but not a primary infrastructure threat.

Assessment Tier: TIER 3 (Arsenal Value – Unauthenticated Stored XSS in Demo Service)
Full analysis: https://github.com/alan-turing-institute/cyber-threat-observatory/blob/main/generic/T3/TIER_3_26-02-04_CVE-2025-70849.md
Rationale:
- `/store` accepts arbitrary unauthenticated uploads and serves them back, enabling stored XSS
- Impact is confined to browser contexts visiting podinfo URLs; no direct RCE or backend compromise
- Podinfo is commonly used as a demo app; exposure in production is usually limited but possible
- Straightforward to exploit and useful for phishing or lateral attacks, but low intrinsic kill chain utility vs infrastructure RCEs
Attractiveness Score: MEDIUM (for Web-Based Campaigns), LOW for Core Infrastructure
DPI Relevance: Not DPI-Specific (Demonstration Microservice / Generic Web)
Vulners reference: https://vulners.com/cve/CVE-2025-70849

---

## In-Depth Analysis

### 1. Software and Deployment Context

- **Software:** podinfo ≤ 6.9.0/6.10.0 – a Go-based microservice commonly used to demonstrate Kubernetes deployments and service meshes
- **Endpoint:** `/store` – key/value storage API
- **Typical deployment:**
  - Test clusters, demos, labs, and sample environments
  - Occasionally present in internet-exposed developer or sandbox clusters

The vulnerable endpoint is usually not considered production-critical, but misconfigurations can expose it to the public internet.

### 2. Vulnerability Mechanics

- **Root cause:** Lack of:
  - Strong Content-Type validation for uploaded content
  - A restrictive Content-Security-Policy on `/store` views
  - Server-side sanitisation of HTML/JavaScript
- **Exploit pattern (per PoC and Packet Storm):**
  1. Attacker sends:
     ```bash
     curl -X POST https://<target>/store \
       -H "Content-Type: application/text" \
       -d '<html><script>alert("CVE-2025-70849")</script></html>'
     ```
  2. The service responds with a hash or identifier for the stored object.
  3. Anyone who visits `https://<target>/store/<hash>` has the payload rendered in their browser, triggering the stored XSS.
- **Impact:**
  - Execution of arbitrary JavaScript in the context of podinfo endpoints
  - Potential theft of cookies or tokens scoped to podinfo, DOM manipulation, or phishing content.

If podinfo shares a domain or cookies with other services, there may be additional risk, but in recommended deployments it is isolated.

### 3. Kill Chain Utility Assessment

**Initial access vs post-compromise**

- The vulnerability is unauthenticated and reachable over the network, which is attractive in theory.
- In practice, podinfo is:
  - Often non-production, and
  - Typically isolated from more critical apps, limiting pivot value.

**Attacker gain**

- Gains include:
  - Control over content served at `/store/<hash>` URLs
  - Ability to host arbitrary scripts under the target’s domain or subdomain
- These can support:
  - Phishing pages
  - Proof-of-concept attack demonstrations
  - Limited session attacks, if any sensitive context is shared

**Barriers and reliability**

- Barriers:
  - Real-world impact depends heavily on how podinfo is exposed and which cookies or credentials, if any, are present in the browser context.
- Reliability:
  - Technically trivial: upload and visit the hash URL.

Under Kill Chain Economics, this is an **arsenal tool** for web-based campaigns and red-team exercises, not a primary infrastructure exploitation vector.

### 4. Organisational Context and DPI Relevance

- **Common usage:** Demos, test clusters, and sample apps in Kubernetes environments.
- **Production risk:** Organisations that have accidentally exposed podinfo on production domains or mixed cookie scopes may incur additional phishing and reputational risks.
- **DPI classification:** Not a DPI platform; risk is limited to web clients and deployment hygiene.

For most operators, this CVE is best viewed as a hygiene and hardening issue in demo/test environments.

### 5. Recommended Mitigations

- **Upgrade:**
  - Update podinfo to a version that:
    - Enforces stronger Content-Type validation on `/store`
    - Applies appropriate HTML-encoding or sanitisation to stored content
    - Implements a restrictive CSP to reduce XSS impact.
- **Deployment hygiene:**
  - Avoid exposing podinfo instances directly to the internet, especially on production domains.
  - Use distinct domains or subdomains with isolated cookies for demo services.
- **Defence-in-depth:**
  - Add WAF rules to block suspicious `/store` uploads (e.g. HTML/JS in text payloads).
  - Monitor for unusual access patterns to `/store/<hash>` URLs.

These mitigations reduce both the ease and the payoff of exploiting CVE-2025-70849, maintaining podinfo’s role as a safe demonstration service.

