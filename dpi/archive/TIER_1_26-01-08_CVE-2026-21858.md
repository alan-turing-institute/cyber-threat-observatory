# CVE-2026-21858: n8n Unauthenticated File Access Leading to RCE

**Assessment Date:** 2026-01-08  
**CVE ID:** CVE-2026-21858  
**CVSS Score:** 10.0 (CRITICAL)  
**Assessment Tier:** TIER 1 - IMMEDIATE  
**Vulners Link:** https://vulners.com/cve/CVE-2026-21858

---

## Executive Summary

CVE-2026-21858 is a critical unauthenticated file access vulnerability in n8n (workflow automation platform) that enables attackers to read arbitrary files on the server, forge administrator sessions, and achieve remote code execution (RCE) through a chain with CVE-2025-68613. The vulnerability affects all versions below 1.121.0 and has been assigned a CVSS score of 10.0. A fully functional public exploit is available on GitHub, and over 26,000 n8n instances are exposed to the internet, making this an immediate threat requiring emergency patching.

**Assessment Tier: TIER 1 (IMMEDIATE)**

**Rationale:**
- Unauthenticated, network-accessible vulnerability (no barriers)
- Public PoC with ready-to-use exploit code available
- High-impact gain: enables RCE, data breach, and system compromise
- Suitable for mass exploitation (26,512 exposed hosts)
- Public-facing deployment pattern (webhooks/forms often internet-exposed)

**Attractiveness Score: MAXIMUM**

**DPI Relevance:** General Infrastructure
- n8n is used across sectors for workflow automation and integrations
- Not specific to DPI domains but widely deployed in enterprise environments
- Compromised instances can expose API credentials, OAuth tokens, and database connections

---

## Software Assessment (Step 0)

### Network Reachability
- **Network-Reachable:** YES
  - n8n is a web application that listens on network ports (typically 5678)
  - Provides HTTP/HTTPS endpoints for webhooks and form submissions
  - Designed to receive network requests from external services

### Deployment Context
- **Primary Application:** Workflow automation platform
  - Used for building and running automated processes
  - Integrates with various services via webhooks and APIs
  - Supports form-based workflows for data collection

- **Typical Deployment:**
  - **Public-Facing:** Often exposed to internet for webhook/form functionality
  - **Internal:** May be deployed internally for enterprise automation
  - **Hybrid:** Some endpoints public (webhooks/forms), others internal (admin UI)

- **Exposure Statistics:**
  - Censys reports **26,512 exposed n8n hosts** globally
  - Majority located in U.S. (7,079), Germany (4,280), France (2,655), Brazil (1,347), Singapore (1,129)
  - Indicates widespread public-facing deployment

### Execution Context
- **Privilege Level:** Varies by deployment
  - May run as root/admin in containerized deployments
  - Typically runs as service account (node user)
  - Can execute workflows with system-level access

- **Execution Environment:**
  - Often containerized (Docker deployments)
  - May run in cloud environments (AWS, Azure, GCP)
  - Can be deployed on-premises or as SaaS

### Application-Specific Context
- **Network Service:** HTTP/HTTPS web application
- **Protocols:** HTTP, HTTPS
- **Authentication:** Admin UI requires authentication, but webhook/form endpoints may be unauthenticated
- **Typical Exposure:** Webhook and form endpoints often exposed to internet for integration purposes

---

## Kill Chain Applicability Assessment

### Step 1: Where Can I Use This Vulnerability?

**Kill Chain Stage:** **INITIAL ACCESS**

The vulnerability enables unauthenticated attackers to:
1. Access arbitrary files on the server (Local File Inclusion - LFI)
2. Read sensitive configuration files and database
3. Forge administrator session tokens
4. Achieve authenticated access
5. Execute remote code through expression injection (CVE-2025-68613)

**Attack Vector:** External, unauthenticated network request to form webhook endpoint

### Step 2: What Value Does This Bring to an Attacker?

**Attacker Gain:** **MAXIMUM**

- **Initial Access:** Unauthenticated file access from outside network
- **Data Breach:** Can read sensitive files including:
  - Configuration files (`/home/node/.n8n/config`) containing encryption keys
  - Database files (`/home/node/.n8n/database.sqlite`) containing admin credentials
  - Environment variables (`/proc/self/environ`)
  - Any file on the system accessible to the n8n process
- **Authentication Bypass:** Can forge admin session tokens using extracted secrets
- **Remote Code Execution:** Can achieve RCE through chain with CVE-2025-68613
- **System Compromise:** Full control over n8n instance and underlying server
- **Lateral Movement:** Compromised n8n provides access to connected services, APIs, and credentials

### Step 3: What Barriers Prevent Immediate Exploitation?

**Barriers:** **NONE**

- **Authentication:** Not required - vulnerability is unauthenticated
- **Network Access:** Not required - can be exploited from external network
- **User Interaction:** Not required - fully automated exploitation possible
- **Specific Configuration:** Not required - affects default form webhook functionality
- **Complexity:** Low - straightforward Content-Type confusion attack

### Step 4: Deployment Scenario Impact

**Deployment Scenario:** **PUBLIC-FACING**

- n8n webhook and form endpoints are **often exposed to the internet** for integration purposes
- 26,512 exposed instances identified globally
- Form workflows are designed to receive unauthenticated submissions
- This deployment pattern maximizes kill chain utility for external attackers

**Kill Chain Impact:**
- **Public-facing software** with **unauthenticated vulnerability** = **Maximum kill chain utility (TIER 1)**

### Step 5: Execution Context Impact

**Execution Context:** **HIGH PRIVILEGE POTENTIAL**

- n8n may run with elevated privileges (root/admin in containers)
- Can execute workflows with system-level access
- Compromised instance provides access to underlying server resources
- Enables privilege escalation and lateral movement

---

## Technical Analysis

### Vulnerability Details

**CVE-2026-21858** is a Content-Type confusion vulnerability in n8n's form webhook handling mechanism. The vulnerability occurs in the `formWebhook()` function, which processes form submissions without validating that the Content-Type header is `multipart/form-data`.

**Root Cause:**
- The `formWebhook()` function calls `copyBinaryFile()` to handle file uploads
- This function accesses `req.body.files` without verifying Content-Type
- An attacker can send `Content-Type: application/json` with a crafted body
- The attacker controls `req.body.files` and can specify arbitrary file paths
- This enables Local File Inclusion (LFI) to read any file on the server

**Vulnerable Code Pattern:**
```javascript
// BEFORE (vulnerable)
const files = (context.getBodyData().files as IDataObject) ?? {};
await context.nodeHelpers.copyBinaryFile(file.filepath, ...)

// AFTER (fixed in 1.121.0)
a.ok(req.contentType === 'multipart/form-data', 'Expected multipart/form-data');
```

### Attack Chain

The vulnerability enables a complete attack chain:

1. **LFI Phase:**
   - Read `/proc/self/environ` to find HOME directory
   - Read `$HOME/.n8n/config` to extract encryption key
   - Read `$HOME/.n8n/database.sqlite` to extract admin credentials

2. **Token Forge Phase:**
   - Derive JWT secret from encryption key: `jwt_secret = sha256(encryption_key[::2]).hexdigest()`
   - Extract admin user ID, email, and password hash from database
   - Forge admin session cookie using derived JWT secret

3. **RCE Phase (CVE-2025-68613):**
   - Use forged admin session to create workflow
   - Exploit expression injection vulnerability
   - Bypass sandbox via `this.process.mainModule.require`
   - Execute arbitrary commands as root

**Full Chain:** Unauthenticated LFI → Admin Token Forge → Sandbox Bypass → RCE

### Affected Versions

- **Vulnerable:** All versions below 1.121.0
- **Fixed:** Version 1.121.0 and later
- **Note:** Latest versions include 1.123.10, 2.1.5, 2.2.4, and 2.3.0

### Impact Assessment

**Confidentiality Impact:** HIGH
- Unauthorized access to sensitive files
- Exposure of encryption keys, credentials, and configuration data
- Database access containing user credentials and workflow data

**Integrity Impact:** HIGH
- Can forge administrator sessions
- Can modify workflows and configurations
- Can achieve remote code execution

**Availability Impact:** NONE (per CVSS)
- Does not directly cause denial of service
- However, RCE can be used to disrupt services

**Scope:** CHANGED
- Attack can impact systems beyond the n8n instance
- Compromised n8n provides access to connected services and APIs

---

## Category Fine-Tuning Assessment

### Category I1: Network-Accessible, No Authentication ✅
- **Status:** APPLIES
- **Adjustment:** Maintain or increase priority
- **Rationale:** Maximum kill chain utility - ideal attack vector for WAA
- **Impact:** TIER 1 confirmed

### Category F1: Public PoC with High Reliability (No Barriers) ✅
- **Status:** APPLIES
- **GitHub Repository:** [Chocapikk/CVE-2026-21858](https://github.com/Chocapikk/CVE-2026-21858)
- **Exploit Quality Assessment:**
  - **Content Type:** Ready-to-use exploit code
  - **Completeness:** Complete Python exploit with full attack chain implementation
  - **Functionality:** Includes LFI, token forge, and RCE capabilities
  - **Documentation:** Comprehensive README with usage instructions
  - **Modification Required:** Minimal to none (ready to use)
  - **Assessment:** Public PoC with High Reliability
- **Adjustment:** Increase to TIER 1 or maintain TIER 1
- **Rationale:** Public PoC reduces attacker fixed costs to near zero
- **Impact:** TIER 1 confirmed

### Category J1: Suitable for Mass Exploitation Campaigns (No Barriers) ✅
- **Status:** APPLIES
- **Indicators:**
  - Affects 26,512+ publicly accessible n8n instances
  - Exploitable via automated scanners (public exploit available)
  - Low detection rate (new vulnerability, limited security tool coverage)
  - Suitable for botnet deployment
  - Unauthenticated attack vector enables mass scanning
- **Adjustment:** Increase to TIER 1 or maintain TIER 1
- **Rationale:** Mass exploitation provides economies of scale for WAA actors
- **Impact:** TIER 1 confirmed

### Category D1: Public-Facing Deployment (Internet-Accessible) ✅
- **Status:** APPLIES
- **Indicators:**
  - 26,512 exposed n8n hosts globally
  - Webhook and form endpoints designed for internet access
  - Commonly deployed as public-facing service
  - Integration use cases require external accessibility
- **Adjustment:** Maintain or increase priority
- **Rationale:** Public-facing software with unauthenticated vulnerability = Maximum kill chain utility
- **Impact:** TIER 1 confirmed

### Category E1: Actively Exploited in the Wild (No Barriers) ⚠️
- **Status:** NOT CONFIRMED
- **Indicators:**
  - Widespread discussion in security community
  - Multiple Reddit posts and security news coverage
  - Public exploit available (increases likelihood of exploitation)
  - No confirmed active exploitation in threat intelligence feeds
- **Assessment:** High likelihood of exploitation given public PoC and exposure, but not confirmed active exploitation
- **Impact:** Does not change TIER 1 classification (already TIER 1 based on other factors)

---

## Kill Chain Utility Formula

**Attractiveness to Attacker = Low Effort / Ease of Use × High Attacker Gain / Impact**

### Attacker Effort: MINIMUM
- **No authentication required** - Zero credential compromise effort
- **No network-level access required** - Can exploit from external network
- **Public PoC available** - Ready-to-use exploit code reduces development costs to near zero
- **Low complexity** - Straightforward Content-Type confusion attack
- **Automated exploitation** - Can be integrated into scanning tools

### Attacker Gain: MAXIMUM
- **Initial access** - Unauthenticated file access from outside
- **Data breach** - Can read sensitive files, credentials, and configuration
- **Authentication bypass** - Can forge admin sessions
- **Remote code execution** - Can achieve RCE through exploit chain
- **System compromise** - Full control over n8n instance and server
- **Lateral movement** - Access to connected services and APIs

**Kill Chain Utility = MINIMUM EFFORT × MAXIMUM GAIN = MAXIMUM PRIORITY (TIER 1)**

---

## Work-Averse Attacker (WAA) Analysis

### Fixed vs. Variable Costs

**Fixed Costs (Exploit Development):** **NEAR ZERO**
- Public PoC available on GitHub (Chocapikk/CVE-2026-21858)
- Ready-to-use Python exploit with full attack chain
- Comprehensive documentation and usage instructions
- Minimal modification required (<10 lines of code)

**Variable Costs (Per-Target Exploitation):** **MINIMUM**
- Single HTTP request to form webhook endpoint
- No authentication or credential compromise required
- Automated exploitation possible via scanning tools
- Low detection risk (new vulnerability, limited security tool coverage)

### Economy of Inaction

**Current Tool Effectiveness:** The public PoC makes this vulnerability immediately usable by WAA actors without any development effort. The availability of ready-to-use exploit code eliminates the "economy of inaction" barrier - attackers can immediately add this to their toolkit.

### One Exploit Per Version Rule

**Version Coverage:** Affects all versions below 1.121.0, providing a large attack surface. However, once a version is patched (1.121.0+), the vulnerability is no longer exploitable. The widespread deployment (26,512 exposed instances) suggests many unpatched instances remain vulnerable.

### WAA Decision-Making

**Utility Assessment:** This vulnerability provides maximum utility to WAA actors:
- **Low effort** (public PoC, unauthenticated, automated)
- **High gain** (RCE, data breach, system compromise)
- **Mass exploitation potential** (26,512 exposed hosts)
- **No barriers** (no authentication, no network access required)

**WAA Conclusion:** This vulnerability is **highly attractive** to WAA actors and will be **immediately weaponized** given the public PoC availability.

---

## DPI Relevance Assessment

**DPI Relevance:** **General Infrastructure**

### Analysis

- **Sector Deployment:** n8n is used across various sectors for workflow automation and service integrations
- **DPI-Specific Use:** Not specifically designed for DPI domains, but may be used in:
  - Government automation workflows
  - Identity service integrations
  - Public service automation
  - API orchestration for digital services
- **Impact on DPI:** While not DPI-specific, compromised n8n instances can expose:
  - API credentials for DPI services
  - OAuth tokens for identity providers
  - Database connections for citizen data
  - Integration secrets for public infrastructure

### Risk to DPI

**Indirect Risk:** HIGH
- Compromised n8n instances can serve as a pivot point to DPI services
- Centralized credential storage in n8n creates single point of failure
- Workflow automation may handle sensitive citizen data
- Integration with identity and authentication services increases risk

**Recommendation:** Organizations using n8n for DPI-related workflows should prioritize patching and review access controls for webhook/form endpoints.

---

## Detection and Mitigation

### Detection Indicators

**Network Indicators:**
- Unauthenticated requests to form webhook endpoints with non-multipart Content-Type
- LFI attempts targeting `/proc/self/environ`, `/home/node/.n8n/config`, `/home/node/.n8n/database.sqlite`
- Anomalous file read operations from n8n process
- Unexpected admin session cookie generation patterns

**Application Indicators:**
- Form webhook requests with `Content-Type: application/json` containing file path references
- File access operations outside expected workflow directories
- Database read operations from unauthenticated contexts
- Expression injection attempts in workflow creation

### Mitigation

**Immediate Actions:**
1. **Upgrade to patched version:** Upgrade to n8n 1.121.0 or later immediately
2. **Restrict public access:** Disable or restrict publicly accessible webhook/form endpoints
3. **Enforce authentication:** Require authentication for all form endpoints where possible
4. **Network controls:** Implement IP allowlists for webhook endpoints
5. **Audit workflows:** Review existing workflows for potential exploitation vectors

**Long-term Actions:**
1. **Content-Type validation:** Ensure all file handling functions validate Content-Type headers
2. **Access controls:** Implement strict access controls for sensitive file operations
3. **Monitoring:** Deploy monitoring for anomalous file access patterns
4. **Security testing:** Include Content-Type confusion in security testing procedures

### Workarounds

**Temporary Mitigations:**
- Restrict or disable publicly accessible webhook and form endpoints until patching
- Implement network-level restrictions (firewall rules, IP allowlists)
- Monitor for exploitation attempts and block malicious IPs
- Review and audit all form-based workflows

**Note:** No official workarounds are available. Upgrading to patched version is the only complete solution.

---

## References

- **CVE:** CVE-2026-21858
- **Vulners:** https://vulners.com/cve/CVE-2026-21858
- **GitHub Advisory:** https://github.com/n8n-io/n8n/security/advisories/GHSA-v4pr-fm98-w9pg
- **Public Exploit:** https://github.com/Chocapikk/CVE-2026-21858
- **The Hacker News:** https://thehackernews.com/2026/01/critical-n8n-vulnerability-cvss-100.html
- **Cyera Research:** https://www.cyera.com/research-labs/ni8mare-unauthenticated-remote-code-execution-in-n8n-cve-2026-21858

---

## Summary

CVE-2026-21858 is a critical unauthenticated file access vulnerability in n8n that enables attackers to read arbitrary files, forge administrator sessions, and achieve remote code execution. The vulnerability affects all versions below 1.121.0 and has been assigned a CVSS score of 10.0. A fully functional public exploit is available on GitHub, and over 26,000 n8n instances are exposed to the internet.

**Assessment Tier: TIER 1 (IMMEDIATE)**

**Rationale:**
- Unauthenticated, network-accessible vulnerability with no barriers
- Public PoC with ready-to-use exploit code available (reduces attacker fixed costs to near zero)
- High-impact gain: enables RCE, data breach, and system compromise through exploit chain
- Suitable for mass exploitation (26,512 exposed hosts globally)
- Public-facing deployment pattern (webhooks/forms often internet-exposed for integration purposes)

**Attractiveness Score: MAXIMUM**

Low attacker effort (public PoC, unauthenticated, automated) combined with maximum attacker gain (RCE, data breach, system compromise) results in maximum kill chain utility. The Work-Averse Attacker will immediately weaponize this vulnerability given the public PoC availability and lack of barriers.

**DPI Relevance: General Infrastructure**

n8n is used across sectors for workflow automation and integrations. While not specific to DPI domains, compromised instances can expose API credentials, OAuth tokens, and database connections, creating indirect risk to DPI services. Organizations using n8n for DPI-related workflows should prioritize patching and review access controls.

**Response:** Patch immediately via emergency change control. Upgrade to n8n 1.121.0 or later. Restrict or disable publicly accessible webhook/form endpoints until patching is complete. Implement network controls and monitoring for exploitation attempts.

